From de5f2b16fba692b412acbf9536cdcf5d3e0f3c3c Mon Sep 17 00:00:00 2001
From: Zihao Yu <yuzihao@ict.ac.cn>
Date: Sat, 4 Sep 2021 15:43:48 +0800
Subject: [PATCH 26/74] provide Makefile for linting

---
 lint/Makefile              | 16 ++++++++++++++++
 lint/README.md             | 15 +++++++++++++++
 lint/verilator-warning.txt |  1 +
 3 files changed, 32 insertions(+)
 create mode 100644 lint/Makefile
 create mode 100644 lint/README.md
 create mode 100644 lint/verilator-warning.txt

diff --git a/lint/Makefile b/lint/Makefile
new file mode 100644
index 00000000..6d70e272
--- /dev/null
+++ b/lint/Makefile
@@ -0,0 +1,16 @@
+# modify to your ID. DO NOT add any trailing space!!!
+ID = 00000000
+
+TOP = ysyx_$(ID)
+V_FILE = $(TOP).v
+LINT_FLAGS = -Wall -Wno-DECLFILENAME
+
+# lint without UNUSED
+lint: $(V_FILE)
+	verilator --lint-only --top-module $(TOP) $(LINT_FLAGS) -Wno-UNUSED $(V_FILE)
+
+# lint with UNUSED
+lint-unused: $(V_FILE)
+	verilator --lint-only --top-module $(TOP) $(LINT_FLAGS) $(V_FILE)
+
+.PHONY: lint lint-unused
diff --git a/lint/README.md b/lint/README.md
new file mode 100644
index 00000000..ad03e659
--- /dev/null
+++ b/lint/README.md
@@ -0,0 +1,15 @@
+
+## 使用Verilator进行代码规范检查步骤说明
+
+1. 将文件`ysyx_学号.v`复制到本目录下
+1. 将本目录中`Makefile`中的`ID`变量修改为学号
+1. 运行`make lint`, Verilator将会报告除`DECLFILENAME`和`UNUSED`之外所有类别的Warning,
+   你需要修改代码来清理它们. Warning的含义可以参考[Verilator手册的说明][verilator warning]
+1. 运行`make lint-unused`, Verilator将会额外报告`UNUSED`类别的Warning,
+   你需要修改代码来尽最大可能清理它们
+1. 若某些`UNUSED`类别的Warning无法清理,
+   需要填写本目录中的文件[verilator-warning.txt][txt]并给出原因,
+   用于向SoC团队和后端设计团队提供参考
+
+[verilator warning]: https://veripool.org/guide/latest/warnings.html#list-of-warnings
+[txt]: ./verilator-warning.txt
diff --git a/lint/verilator-warning.txt b/lint/verilator-warning.txt
new file mode 100644
index 00000000..f29dee60
--- /dev/null
+++ b/lint/verilator-warning.txt
@@ -0,0 +1 @@
+测试
-- 
2.34.1

